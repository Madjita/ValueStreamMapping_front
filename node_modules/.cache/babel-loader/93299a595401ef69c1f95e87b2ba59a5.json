{"ast":null,"code":"var _jsxFileName = \"/Users/sergeismogliuk/Documents/Project/My_experience/New_project_diplom/front/src/Component/CustomizedAccordiongsHeader.tsx\",\n    _s = $RefreshSig$();\n\nimport moment from 'moment';\nimport React, { useState } from 'react';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport ArchiveIcon from '@material-ui/icons/Archive';\nimport StopIcon from '@material-ui/icons/Stop';\nimport WorkIcon from '@material-ui/icons/Work';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst URL = 'ws://192.168.0.2:5001/wsItem';\n\nconst CustomizedAccordiongsHeader = props => {\n  _s();\n\n  const [order, setOrder] = useState(); //props.data\n\n  const [bad, setBad] = useState(false);\n  const [textPeriod, setTextPeriod] = useState(\"\"); //const {orders, loading} = useTypedSelector(state => state.orders);\n  //const {updateInfoOrder} = useActionOrders()\n  //const prevOrder = usePrevious(order) as IDataOrder | undefined;\n\n  /* React.useEffect(() => {\n       const timer = setTimeout(() => updateInfoOrder(props.data), 1000); \n       return () => {\n         clearTimeout(timer);\n          var obj = orders.find(o=> o.id === order.id) as IDataOrder;\n         console.log(\"timer CustomizedAccordiongsHeader =\",orders[0].tActual);\n         setOrder(obj)\n       };  \n       })*/\n\n  /* React.useEffect(() => {\n        if(prevOrder != undefined)\n        {\n            if(prevOrder.tActual  != order.tActual)\n            {\n                setOrder(props.data)\n            }\n        }\n    },[props.data])*/\n\n  /* console.log(prevOrder, props.data)\n   if(prevOrder != undefined)\n   {\n          \n    }*/\n  ///\n\n  const socket = React.useRef(null);\n  const [reconnect, setRecconect] = React.useState(false);\n  React.useEffect(() => {\n    console.log(\"Set socket after order= \", socket.current);\n\n    if (!socket.current || reconnect === false) {\n      console.log(\"Set socket = \", socket.current);\n      socket.current = new WebSocket(URL);\n\n      socket.current.onmessage = e => {\n        const OrdersFromServer = JSON.parse(e.data); //console.log(\"e\", OrdersFromServer);\n        //console.log(\"e order\", order);\n\n        setOrder(OrdersFromServer);\n      };\n\n      socket.current.onopen = () => {\n        // on connecting, do nothing but log it to the console\n        console.log('connected');\n        socket.current.send(JSON.stringify({\n          id: props.data.id\n        }));\n      };\n\n      socket.current.onerror = e => {\n        console.log(\"eror\", e.data);\n        console.log(\"CONNECTION CLOSED\", e.data);\n        socket.current.close(1000, \"\");\n        setRecconect(true);\n      };\n\n      socket.current.onclose = e => {\n        console.log(\"CONNECTION CLOSED\", e.data);\n        socket.current.close(1000, \"\");\n        setRecconect(true);\n      };\n    }\n\n    return () => {\n      if (socket.current) {\n        socket.current.close(1000, \"\");\n      }\n    };\n  }, [socket, reconnect]);\n\n  if (order === null || order === undefined) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u041D\\u0435 \\u043D\\u0430\\u0448\\u0435\\u043B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 14\n    }, this);\n  } //console.log(\"rerender Order = \", order?.id)\n  ///\n\n  /* if(order?.tActual  != props.data.tActual)\n   {\n       setOrder(props.data)\n   }*/\n\n\n  const {\n    name,\n    tActual,\n    tPlan\n  } = order;\n  let timeTActual = moment.unix(tActual).utc().format('H:m:s');\n  let timeTPlan = moment.unix(tPlan).utc().format('H:m:s');\n\n  const ConvertPeriodToString = timePeriod => {\n    var list = timePeriod.split(' ');\n    let text = timePeriod; //console.log(list);\n\n    if (list[0] === 'in') {\n      if (list[1] === 'a') {\n        text = \"Отставание на несколько сукунд\";\n\n        if (list[2] === 'minute') {\n          text = \"Отставание на 1 м\";\n        }\n      } else {\n        let t = list[1];\n        text = \"Отставание на \" + t;\n\n        switch (list[2]) {\n          case \"hours\":\n            text += \" ч\";\n            break;\n\n          case \"minutes\":\n            text += \" м\";\n            break;\n        }\n      } // console.log(text)\n\n    } else {\n      if (list[0] === 'a') {\n        text = \"В запасе много времени\";\n\n        if (list[2] === 'minute') {\n          text = \"Отставание на 1 м\";\n        }\n      } else {\n        text = \"В запасе \" + list[0];\n\n        switch (list[1]) {\n          case \"hours\":\n            text += \" ч\";\n            break;\n\n          case \"minutes\":\n            text += \" м\";\n            break;\n        }\n      }\n    }\n\n    if (textPeriod != text) {\n      setTextPeriod(text);\n    }\n  }; //var diff = moment(\"23:07\").unix() - moment(\"22:07\").unix();\n\n\n  let timePeriod = '';\n  let text = '';\n\n  if (tPlan - tActual === 0) {\n    timePeriod = moment.unix(tPlan - tActual).utc().format('H:m:s');\n    text = '';\n  } else {\n    if (tPlan - tActual > 0) {\n      timePeriod = moment.unix(tPlan - tActual).utc().format('H:m:s');\n      text = 'Осталось';\n    } else {\n      timePeriod = moment.unix(tActual - tPlan).utc().format('H:m:s');\n      text = 'Отставание на';\n    }\n  } // let timePeriod =  moment.unix(tPlan).from(moment.unix(tActual))   //ConvertPeriodToString( moment.unix(tActual).utc().from(moment.unix(tPlan).utc()) )\n\n\n  if (tActual > tPlan && bad === false) {\n    setBad(true);\n  }\n\n  if (tActual < tPlan && bad) {\n    setBad(false);\n  }\n\n  let orderRole; //switch(props.data.orderRole)\n\n  switch (order.orderRole) {\n    case 1:\n      orderRole = /*#__PURE__*/_jsxDEV(PlayArrowIcon, {\n        style: {\n          color: 'gray'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 25\n      }, this);\n      break;\n\n    case 2:\n      orderRole = /*#__PURE__*/_jsxDEV(WorkIcon, {\n        style: {\n          color: 'orange'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 26\n      }, this);\n      break;\n\n    case 3:\n      orderRole = /*#__PURE__*/_jsxDEV(ArchiveIcon, {\n        style: {\n          color: 'green'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 26\n      }, this);\n      break;\n\n    case 4:\n      orderRole = /*#__PURE__*/_jsxDEV(StopIcon, {\n        style: {\n          color: 'red'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 26\n      }, this);\n      break;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'grid',\n      gridTemplateColumns: '100px auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid',\n        gridTemplateColumns: '1fr 1fr 1fr'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-around'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u0410\\u043A\\u0442\\u0443\\u0430\\u043B\\u044C\\u043D\\u043E\\u0435 \\u0432\\u0435\\u0440\\u043C\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            backgroundColor: bad ? 'red' : '',\n            color: bad ? \"white\" : \"\"\n          },\n          children: timeTActual\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-around'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: timePeriod\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-around'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u041F\\u043B\\u0430\\u043D\\u043E\\u0432\\u043E\\u0435 \\u0432\\u0440\\u0435\\u043C\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            backgroundColor: bad ? 'red' : '',\n            color: bad ? \"white\" : \"\"\n          },\n          children: timeTPlan\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: orderRole\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 284,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CustomizedAccordiongsHeader, \"ifziq5C34XSuc7IQlscvgfB+2Ew=\");\n\n_c = CustomizedAccordiongsHeader;\nexport default CustomizedAccordiongsHeader;\n\nvar _c;\n\n$RefreshReg$(_c, \"CustomizedAccordiongsHeader\");","map":{"version":3,"sources":["/Users/sergeismogliuk/Documents/Project/My_experience/New_project_diplom/front/src/Component/CustomizedAccordiongsHeader.tsx"],"names":["moment","React","useState","PlayArrowIcon","ArchiveIcon","StopIcon","WorkIcon","URL","CustomizedAccordiongsHeader","props","order","setOrder","bad","setBad","textPeriod","setTextPeriod","socket","useRef","reconnect","setRecconect","useEffect","console","log","current","WebSocket","onmessage","e","OrdersFromServer","JSON","parse","data","onopen","send","stringify","id","onerror","close","onclose","undefined","name","tActual","tPlan","timeTActual","unix","utc","format","timeTPlan","ConvertPeriodToString","timePeriod","list","split","text","t","orderRole","color","display","gridTemplateColumns","justifyContent","backgroundColor"],"mappings":"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","sourcesContent":["import moment from 'moment';\nimport React,{useState} from 'react'\nimport IDataOrder from './Data/IDataOrder';\n\nimport PauseIcon from '@material-ui/icons/Pause';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport ArchiveIcon from '@material-ui/icons/Archive';\nimport StopIcon from '@material-ui/icons/Stop';\nimport WorkIcon from '@material-ui/icons/Work';\n\nimport { IconButton } from '@material-ui/core';\n\nimport { useActionOrders } from '../hooks/useActionOrders';\nimport { useTypedSelector } from '../hooks/leftMenuSelector';\nimport usePrevious from '../hooks/usePrevious';\n\n\nimport ip from '../global'\nconst URL = 'ws://192.168.0.2:5001/wsItem';\n\ninterface IDataHeader{\n    name?: string,\n    TActual: number,\n    TPlan: number\n}\n\n\n\nconst CustomizedAccordiongsHeader = (props:{data: IDataOrder})  => \n{\n    const [order, setOrder] = useState<IDataOrder>(); //props.data\n\n    const [bad,setBad] = useState(false);\n    const [textPeriod,setTextPeriod] = useState(\"\");\n\n    //const {orders, loading} = useTypedSelector(state => state.orders);\n    //const {updateInfoOrder} = useActionOrders()\n\n    //const prevOrder = usePrevious(order) as IDataOrder | undefined;\n\n   /* React.useEffect(() => {\n        const timer = setTimeout(() => updateInfoOrder(props.data), 1000); \n        return () => {\n          clearTimeout(timer);\n\n          var obj = orders.find(o=> o.id === order.id) as IDataOrder;\n          console.log(\"timer CustomizedAccordiongsHeader =\",orders[0].tActual);\n          setOrder(obj)\n        };  \n        })*/\n\n  /* React.useEffect(() => {\n        if(prevOrder != undefined)\n        {\n            if(prevOrder.tActual  != order.tActual)\n            {\n                setOrder(props.data)\n            }\n        }\n    },[props.data])*/\n\n   /* console.log(prevOrder, props.data)\n    if(prevOrder != undefined)\n    {\n           \n     }*/\n\n///\n\n\n    const socket = React.useRef(null)  as any;\n    const [reconnect, setRecconect] = React.useState(false);\n  \n      React.useEffect(() => {\n\t\tconsole.log(\"Set socket after order= \", socket.current);\n\t\tif (!socket.current || reconnect === false) {\n\t\t\tconsole.log(\"Set socket = \", socket.current);\n\t\t\tsocket.current = new WebSocket(URL) ;\n\t\t\tsocket.current.onmessage = (e: any) => {\n\t\t\t\t\n               \n\t\t\t\tconst OrdersFromServer = JSON.parse(e.data) as IDataOrder;  \n\t\t\t\t//console.log(\"e\", OrdersFromServer);\n                //console.log(\"e order\", order);\n\t\t\t\tsetOrder(OrdersFromServer);\n\t\t\t};\n\n\t\t\tsocket.current.onopen = () => {\n\t\t\t\t// on connecting, do nothing but log it to the console\n\t\t\t\tconsole.log('connected')\n\t\t\t\tsocket.current.send(JSON.stringify({ id: props.data.id}));\n\t\t\t}\n\n\t\t\t\n\n\t\t\tsocket.current.onerror = (e : any) => {\n\t\t\t\tconsole.log(\"eror\", e.data);\n        console.log(\"CONNECTION CLOSED\", e.data);\n\t\t\t\tsocket.current.close(1000, \"\");\n\n        setRecconect(true);\n\t\t\t};\n\n\t\t\tsocket.current.onclose = (e : any)=>{\n\t\t\t\tconsole.log(\"CONNECTION CLOSED\", e.data);\n\t\t\t\tsocket.current.close(1000, \"\");\n\n\t\t\t\tsetRecconect(true);\n\t\t\t}\n\t\t}\n\t\treturn () => {\n\t\t  if (socket.current) {\n\t\t\tsocket.current.close(1000, \"\");\n\t\t  }\n\t\t};\n\t  }, [socket,reconnect]);\n\n\n      if(order === null || order === undefined)\n      {\n          return (\n             <p>Не нашел</p>\n          )\n      }\n\n      //console.log(\"rerender Order = \", order?.id)\n\n\n///\n\n\n    /* if(order?.tActual  != props.data.tActual)\n     {\n         setOrder(props.data)\n     }*/\n\n   \n   \n    const {\n        name,\n        tActual,\n        tPlan} = order as IDataOrder;\n  \n\n    \n\n    let timeTActual = moment.unix(tActual).utc().format('H:m:s')\n    let timeTPlan = moment.unix(tPlan).utc().format('H:m:s')\n    \n\n\n    const ConvertPeriodToString = (timePeriod: any)=>\n    {\n        var list = timePeriod.split(' ')\n\n        let text = timePeriod;\n        //console.log(list);\n\n        if(list[0] === 'in')\n        {\n\n\n            if(list[1] === 'a')\n            {\n                text = \"Отставание на несколько сукунд\"\n                if(list[2] === 'minute')\n                {\n                    text = \"Отставание на 1 м\"\n                }\n                \n            }\n            else\n            {\n                let t =list[1];\n                text = \"Отставание на \"+ t\n\n                switch(list[2])\n                {\n                    case \"hours\": \n                        text += \" ч\"\n                    break;\n                    case \"minutes\": \n                        text += \" м\"\n                    break;\n                    \n                }\n            }\n           // console.log(text)\n        }\n        else\n        {\n            if(list[0] === 'a')\n            {\n                text = \"В запасе много времени\"\n                if(list[2] === 'minute')\n                {\n                    text = \"Отставание на 1 м\"\n                }\n                \n            }\n            else\n            {\n                text = \"В запасе \" + list[0];\n                switch(list[1])\n                {\n                    case \"hours\": \n                        text += \" ч\"\n                    break;\n                    case \"minutes\": \n                        text += \" м\"\n                    break;\n                    \n                }\n            }\n           \n        }\n\n        if(textPeriod != text)\n        {\n            setTextPeriod(text);\n        }\n       \n    }\n\n  //var diff = moment(\"23:07\").unix() - moment(\"22:07\").unix();\n  \n  let timePeriod = '';\n  let text = '';\n  if(tPlan - tActual  === 0)\n  {\n    timePeriod  = moment.unix(tPlan-tActual).utc().format('H:m:s');\n    text = '';\n  }\n  else\n  {\n    if(tPlan - tActual > 0)\n    {\n           timePeriod   = moment.unix(tPlan-tActual).utc().format('H:m:s');\n           text = 'Осталось';\n    }\n    else\n    {\n          timePeriod   = moment.unix(tActual-tPlan).utc().format('H:m:s');\n          text = 'Отставание на';\n    }\n  }\n \n  \n\n// let timePeriod =  moment.unix(tPlan).from(moment.unix(tActual))   //ConvertPeriodToString( moment.unix(tActual).utc().from(moment.unix(tPlan).utc()) )\n\n\n    if(tActual > tPlan && bad === false)\n    {\n        setBad(true);\n    }\n\n    if(tActual < tPlan && bad)\n    {\n        setBad(false);\n    }\n\n\n    let orderRole;\n\n    //switch(props.data.orderRole)\n    switch(order.orderRole)\n    {\n        case 1:\n            orderRole = <PlayArrowIcon style={{color: 'gray'}}/>\n        break;\n        case 2:\n            orderRole =  <WorkIcon style={{color: 'orange'}}/>\n        break;\n        case 3:\n            orderRole =  <ArchiveIcon style={{color: 'green'}}/>\n        break;\n        case 4:\n            orderRole =  <StopIcon style={{color: 'red'}}/>\n        break;\n    }\n\n    return (\n        <div style={{display: 'grid', gridTemplateColumns: '100px auto',}}>\n                <p>{name}</p>\n                <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr 1fr'}}>\n                <div style={{display: 'flex', justifyContent:'space-around'}} >\n                    <p>Актуальное вермя</p>\n                    <p style ={{backgroundColor: bad ? 'red': '', color: bad ? \"white\": \"\" }}>{timeTActual}</p>\n                  </div>\n                  <div style={{display: 'flex', justifyContent:'space-around'}} >\n                    <p>{text}</p>\n                    <p>{timePeriod}</p>\n                  </div>\n                  <div style={{display: 'flex', justifyContent:'space-around'}} >\n                    <p>Плановое время</p>\n                    <p style ={{backgroundColor: bad ? 'red': '', color: bad ? \"white\": \"\" }}>{timeTPlan}</p>\n                    <p>{orderRole}</p>\n                  </div>\n                </div>\n        </div>\n    )\n}\n\n\nexport default CustomizedAccordiongsHeader;"]},"metadata":{},"sourceType":"module"}